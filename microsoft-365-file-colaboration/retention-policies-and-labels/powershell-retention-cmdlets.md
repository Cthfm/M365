# Powershell: Retention CMDLets

## Overview

The following reference CMDLets that are associated with Data Retention.



| Cmdlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Description                                                                                  | Applicable locations                                                                                                                                                                                                                                                                       |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| <p><a href="https://learn.microsoft.com/en-us/powershell/module/exchange/enable-compliancetagstorage">Enable-ComplianceTagStorage</a><br><br><a href="https://learn.microsoft.com/en-us/powershell/module/exchange/get-compliancetagstorage">Get-ComplianceTagStorage</a></p>                                                                                                                                                                                                                                                                                                                 | A one-time operation to create storage, or view that storage for retention labels            | <p>Exchange mailboxes<br><br>SharePoint sites (or SharePoint classic and communication sites)<br><br>OneDrive accounts<br><br>Microsoft 365 Group mailboxes &#x26; sites</p>                                                                                                               |
| <p><a href="https://learn.microsoft.com/en-us/powershell/module/exchange/get-compliancetag">Get-ComplianceTag</a><br><br><a href="https://learn.microsoft.com/en-us/powershell/module/exchange/new-compliancetag">New-ComplianceTag</a><br><br><a href="https://learn.microsoft.com/en-us/powershell/module/exchange/remove-compliancetag">Remove-ComplianceTag</a><br><br><a href="https://learn.microsoft.com/en-us/powershell/module/exchange/set-compliancetag">Set-ComplianceTag</a></p>                                                                                                 | View, create, delete, configure retention labels                                             | <p>Exchange mailboxes<br><br>SharePoint sites (or SharePoint classic and communication sites)<br><br>OneDrive accounts<br><br>Microsoft 365 Group mailboxes &#x26; sites</p>                                                                                                               |
| <p><a href="https://learn.microsoft.com/en-us/powershell/module/exchange/get-recordreviewnotificationtemplateconfig">Get-RecordReviewNotificationTemplateConfig</a><br><br><a href="https://learn.microsoft.com/en-us/powershell/module/exchange/set-recordreviewnotificationtemplateconfig">Set-RecordReviewNotificationTemplateConfig</a></p>                                                                                                                                                                                                                                               | View or configure the disposition review notification and reminder settings                  | <p>Exchange mailboxes<br><br>SharePoint sites (or SharePoint classic and communication sites)<br><br>OneDrive accounts<br><br>Microsoft 365 Group mailboxes &#x26; sites</p>                                                                                                               |
| <p><a href="https://learn.microsoft.com/en-us/powershell/module/exchange/get-retentioncompliancepolicy">Get-RetentionCompliancePolicy</a><br><br><a href="https://learn.microsoft.com/en-us/powershell/module/exchange/new-retentioncompliancepolicy">New-RetentionCompliancePolicy</a><br><br><a href="https://learn.microsoft.com/en-us/powershell/module/exchange/remove-retentioncompliancepolicy">Remove-RetentionCompliancePolicy</a><br><br><a href="https://learn.microsoft.com/en-us/powershell/module/exchange/set-retentioncompliancepolicy">Set-RetentionCompliancePolicy</a></p> | View, create, delete, configure retention policies and retention label policies              | <p>Exchange email<br><br>SharePoint sites (or SharePoint classic and communication sites)<br><br>OneDrive accounts<br><br>Microsoft 365 Group mailboxes &#x26; sites<br><br>Skype for Business<br><br>Exchange public folders<br><br>Teams chat messages<br><br>Teams channel messages</p> |
| <p><a href="https://learn.microsoft.com/en-us/powershell/module/exchange/get-retentioncompliancerule">Get-RetentionComplianceRule</a><br><br><a href="https://learn.microsoft.com/en-us/powershell/module/exchange/new-retentioncompliancerule">New-RetentionComplianceRule</a><br><br><a href="https://learn.microsoft.com/en-us/powershell/module/exchange/set-retentioncompliancerule">Set-RetentionComplianceRule</a><br><br><a href="https://learn.microsoft.com/en-us/powershell/module/exchange/remove-retentioncompliancerule">Remove-RetentionComplianceRule</a></p>                 | View, create, configure, delete settings (rules) for retention policies and retention labels | <p>Exchange email<br><br>SharePoint sites (or SharePoint classic and communication sites)<br><br>OneDrive accounts<br><br>Microsoft 365 Group mailboxes &#x26; sites<br><br>Skype for Business<br><br>Exchange public folders<br><br>Teams chat messages<br><br>Teams channel messages</p> |

### Retention cmdlets specific to Teams private channels and Viva Engage <a href="#retention-cmdlets-specific-to-teams-private-channels-and-viva-engage" id="retention-cmdlets-specific-to-teams-private-channels-and-viva-engage"></a>

Use the following cmdlets when the locations are for **Teams private channel messages**, **Viva Engage user messages**, or **Viva Engage community messages**.

When the locations are for Teams chat messages, Teams channel messages, Exchange email, SharePoint sites (or SharePoint classic and communication sites), OneDrive accounts, Microsoft 365 Group mailboxes & sites, Skype for Business, or Exchange public folders, use the cmdlets listed in the [previous section](https://learn.microsoft.com/en-us/purview/retention-cmdlets#retention-cmdlets-for-most-locations).

Expand table

| Cmdlet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Description                                                             | Applicable locations                                                                                         |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------ |
| <p><a href="https://learn.microsoft.com/en-us/powershell/module/exchange/get-appretentioncompliancepolicy">Get-AppRetentionCompliancePolicy</a><br><br><a href="https://learn.microsoft.com/en-us/powershell/module/exchange/new-appretentioncompliancepolicy">New-AppRetentionCompliancePolicy</a><br><br><a href="https://learn.microsoft.com/en-us/powershell/module/exchange/remove-appretentioncompliancepolicy">Remove-AppRetentionCompliancePolicy</a><br><br><a href="https://learn.microsoft.com/en-us/powershell/module/exchange/set-appretentioncompliancepolicy">Set-AppRetentionCompliancePolicy</a></p> | View, create, delete, configure retention policies                      | <p>Teams private channel messages<br><br>Viva Engage user messages<br><br>Viva Engage community messages</p> |
| <p><a href="https://learn.microsoft.com/en-us/powershell/module/exchange/get-appretentioncompliancerule">Get-AppRetentionComplianceRule</a><br><br><a href="https://learn.microsoft.com/en-us/powershell/module/exchange/new-appretentioncompliancerule">New-AppRetentionComplianceRule</a><br><br><a href="https://learn.microsoft.com/en-us/powershell/module/exchange/remove-appretentioncompliancerule">Remove-AppRetentionComplianceRule</a><br><br><a href="https://learn.microsoft.com/en-us/powershell/module/exchange/set-appretentioncompliancerule">Set-AppRetentionComplianceRule</a></p>                 | View, create, configure, delete settings (rules) for retention policies | <p>Teams private channel messages<br><br>Viva Engage user messages<br><br>Viva Engage community messages</p> |
