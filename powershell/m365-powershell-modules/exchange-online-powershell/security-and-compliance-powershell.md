# Security & Compliance PowerShell

The **Security & Compliance Center (SCC) PowerShell module** is a crucial tool for administrators and security professionals managing **Microsoft 365 security, compliance, and governance tasks**. It provides a way to interact programmatically with compliance-related features like **eDiscovery, auditing, retention policies, sensitivity labels**, and more through PowerShell commands.

This module is highly valuable for automating incident response, ensuring policy compliance, and managing large-scale security configurations efficiently.

***

### **Capabilities and Use Cases**

1. **Unified Security and Compliance Management:**\
   The module centralizes tasks across **Exchange Online, SharePoint, Microsoft Teams, and OneDrive**, helping organizations manage compliance policies from a single interface.
2. **Automation of Routine Compliance Tasks:**\
   The SCC module facilitates the automation of:
   * **eDiscovery searches**: Collect data for legal investigations using `New-ComplianceSearch`.
   * **Audit log reviews**: Track user activity across Microsoft 365 with `Search-UnifiedAuditLog`.
   * **Data retention policies**: Manage data lifecycle through `Get-RetentionCompliancePolicy` and `New-RetentionCompliancePolicy`.
   * **Alerts and Sensitivity Labels**: Configure and monitor alerts related to sensitive data handling.
3. **Integration with Microsoft Purview**:\
   The SCC PowerShell module integrates with **Microsoft Purview Compliance** solutions, enabling you to define policies and manage compliance features directly from the command line. Purview serves as the unified platform for data governance, privacy management, and compliance across Microsoft 365 services.

***

### **How to Install and Use the SCC PowerShell Module**

#### **Prerequisites**:

To use the SCC module:

* Install the **Exchange Online PowerShell V2 (EXO V2)** module, which includes the `Connect-IPPSSession` command for accessing SCC features.
* Assign appropriate **permissions and roles** via **Microsoft Purview** or **Azure AD**. Some roles include:
  * **Compliance Administrator**
  * **eDiscovery Manager**
  * **Security Reader**

#### **Connecting to the Security & Compliance Center**

Use the following command to initiate a PowerShell session with the SCC:

```powershell
Connect-IPPSSession
```

This command connects to the Security & Compliance Center and allows you to run compliance-related commands. Microsoft recommends enabling **Multi-Factor Authentication (MFA)** for enhanced security when connecting.

***

### **Key Cmdlets for SCC PowerShell Module**

| **Cmdlet**                      | **Purpose**                                                                               |
| ------------------------------- | ----------------------------------------------------------------------------------------- |
| `Search-UnifiedAuditLog`        | Search the Unified Audit Log to track activity across Microsoft 365 services.             |
| `New-ComplianceSearch`          | Create a new eDiscovery search to locate specific data within Microsoft 365.              |
| `Get-RetentionCompliancePolicy` | View existing retention policies for compliance management.                               |
| `New-RetentionCompliancePolicy` | Create new retention policies to control data lifecycle.                                  |
| `New-ComplianceSearchAction`    | Perform actions (e.g., export, purge) on search results generated by eDiscovery searches. |

***

### **Permissions and Security Considerations**

To access and run SCC PowerShell commands, administrators must have the correct **RBAC (Role-Based Access Control)** roles assigned. Common roles include:

* **Compliance Administrator**: Full access to compliance features, including eDiscovery and retention.
* **eDiscovery Manager**: Restricted to eDiscovery searches and related tasks.
* **Security Reader**: View-only access to security-related data.

These roles can be managed via the **Azure AD Portal** or **Microsoft Purview Compliance Portal**.

***

### **Use Cases for Incident Response and Governance**

1. **Incident Response Automation**:\
   Security teams can automate incident response by using commands like `Search-UnifiedAuditLog` to identify suspicious activities across Microsoft 365. Combined with `New-ComplianceSearchAction`, administrators can isolate or remove malicious data programmatically.
2. **Governance and Data Retention**:\
   Organizations can enforce data retention policies using `New-RetentionCompliancePolicy` to meet regulatory requirements like **GDPR** or **HIPAA**.
3. **Audit Log Reviews and Alerts**:\
   The SCC module provides visibility into user activities across various services, helping administrators investigate and act on anomalies. Automated scripts can notify security teams when suspicious behavior is detected, ensuring quicker responses to potential breaches.

***

### **Best Practices for Using SCC PowerShell Module**

1. **Enable Multi-Factor Authentication (MFA)**:\
   As the SCC module accesses sensitive data, it is recommended to enforce **MFA** for administrators to minimize the risk of unauthorized access.
2. **Automate Compliance Tasks Using Scripts**:\
   Writing PowerShell scripts to automate recurring compliance activities, like eDiscovery searches or retention policy checks, improves efficiency and ensures policies are consistently enforced.
3. **Role-Based Access Control (RBAC)**:\
   Carefully assign roles and permissions to prevent unauthorized access. Use the **least privilege principle**, ensuring users only have access to the resources necessary for their role.
4. **Monitor Sessions and Connections**:\
   Regularly monitor **PowerShell sessions** and connections to ensure that only approved users are accessing compliance-related data.

[https://learn.microsoft.com/en-us/powershell/exchange/scc-powershell?view=exchange-ps](https://learn.microsoft.com/en-us/powershell/exchange/scc-powershell?view=exchange-ps)
